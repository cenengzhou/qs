
<ng-container *ngIf="mode == 'f'">[#ftl]</ng-container>
<div id="form4-container">
  <ng-container *ngTemplateOutlet="form4"></ng-container>
</div>

<ng-template #form4>
  <ng-container *ngTemplateOutlet="tableHead"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="tableTender"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="table3Q"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="tableVariances"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="tableChange"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="submit"></ng-container>
  <br />
  <ng-container *ngTemplateOutlet="dates"></ng-container>
</ng-template>

<ng-template #tableHead>
  <table id="tableHead">
    <tr>
      <td>
        <ng-container *ngTemplateOutlet="logoBase64"></ng-container>
      </td>
      <td class="headertitle">TENDER ANALYSIS</td>
      <td>
        PDS/07/Form 4
        <ng-container *ngIf="mode == 'f'">
          <ng-container *ngTemplateOutlet="printBtn"></ng-container>
        </ng-container>
      </td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTender>
  <table class="border2">
    <tbody>
      <tr>
        <td colspan="12">
          <ng-container *ngTemplateOutlet="tableTenderJob"></ng-container>
        </td>
      </tr>
      <tr>
        <td class="th" colspan="6">TYPE</td>
        <td class="th" colspan="6">FORM OF CONTRACT</td>
      </tr>
      <tr>
        <td colspan="6">
          <ng-container *ngTemplateOutlet="tableTenderType"></ng-container>
        </td>
        <td colspan="6">
          <ng-container
            *ngTemplateOutlet="tableTenderTypeContract"
          ></ng-container>
        </td>
      </tr>
      <tr *ngFor="let tenderer of get('tenderList')">
        <ng-container
          *ngTemplateOutlet="
            tableTenderTenderer;
            context: { tenderer: tenderer }
          "
        ></ng-container>
      </tr>
      <ng-container *ngIf="mode == 'f'">
        <ng-container *ngTemplateOutlet="tableTenderTendererBodyF"></ng-container>
      </ng-container>
      <tr>
        <td colspan="6">
          <ng-container *ngTemplateOutlet="tableTenderRcm"></ng-container>
        </td>
        <td colspan="6">
          <ng-container *ngTemplateOutlet="tableTenderRmk"></ng-container>
        </td>
      </tr>
      <tr>
        <td colspan="6" style="width: 50%">
          <ng-container *ngTemplateOutlet="tableTenderBy"></ng-container>
        </td>
        <td colspan="6" style="width: 50%">
          <ng-container *ngTemplateOutlet="tableTenderPds4_5_18"></ng-container>
        </td>
      </tr>
      <tr *ngFor="let approvers of v.approversList">
        <ng-container
          *ngTemplateOutlet="
            tableTenderApprovers;
            context: { approvers: approvers }
          "
        ></ng-container>
      </tr>
      <tr>
        <td colspan="12" class="footerComment">
          Other approvals via ERP Approval System as per Delegated Levels of
          Authority (DLOA) and Project Delivery System (PDS) **<br />Estimating
          Manager & BU Commercial Lead (All) \ Director (Award > $5M or loss
          >$0.5M) \ Executive Director (Award > $15M or loss >$1.5M) \ Chief
          Executive (Award > $25M or loss >$2.5M)
        </td>
      </tr>
    </tbody>
  </table>
</ng-template>

<ng-template #tableTenderJob>
  <table id="tableTenderJob">
    <tr>
      <td class="nowrap">Project Job Number & Title:</td>
      <td class="border1b" [innerHTML]="get('jobTitle')">&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">Package Number & Description:</td>
      <td class="border1b" [innerHTML]="get('jobPackage')">&nbsp;</td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderType>
  <table class="footerComment" id="tableTenderType">
    <tr>
      <td class="nowrap">Domestic Sub-Contractor</td>
      <td class="typebox" [innerHTML]="get('typeDsc')"></td>
      <td class="nowrap">Internal Business</td>
      <td class="typebox" [innerHTML]="get('typeIb')"></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">Nominated Sub-Contractor</td>
      <td class="typebox" [innerHTML]="get('typeNsc')"></td>
      <td class="nowrap">Consultant</td>
      <td class="typebox" [innerHTML]="get('typeC')"></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">Named Sub-Contractor</td>
      <td class="typebox" [innerHTML]="get('typeNdsc')"></td>
      <td colspan="3">
        <table>
          <tr>
            <td class="nowrap" style="width: 50px;">Others</td>
            <td class="typebox" style="width: 10px;" [innerHTML]="get('typeOthers')"></td>
            <td class="border1b"  style="width: 150px;" [innerHTML]="get('typeOthersDesc')">&nbsp;</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderTypeContract>
  <table class="footerComment" id="tableTenderTypeContract">
    <tr>
      <td class="nowrap">Major Form of Sub-Contract</td>
      <td class="typebox" [innerHTML]="get('focMajor')"></td>
      <td class="nowrap">Consultancy Agreement</td>
      <td class="typebox" [innerHTML]="get('focCA')"></td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">Minor Form of Sub-Contract</td>
      <td class="typebox" [innerHTML]="get('focMinor')"></td>
      <td class="nowrap" colspan="2">Design \ Checking \ Other *</td>
      <td>&nbsp;</td>
    </tr>
    <tr>
      <td class="nowrap">Internal Works Order (IWO)[#if subcontract.formOfSubcontract == "Internal Trading"]<br>({{'${subcontract.internalJobNo}'}})[/#if]</td>
      <td class="typebox" [innerHTML]="get('focIT')"></td>
      <td colspan="3">
        <table>
          <tr>
            <td class="nowrap" style="width: 50px;">Others</td>
            <td class="typebox" style="width: 10px;" [innerHTML]="get('focOthers')"></td>
            <td class="border1b" style="width: 150px;" [innerHTML]="get('focOthersDesc')">&nbsp;</td>
          </tr>
        </table>
      </td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderTenderer let-tenderer="tenderer">
  <td
    [ngClass]="{ th: tenderer.isHeader }"
    colspan="4"
    [innerHTML]="tenderer.name"
  ></td>
  <td
    [ngClass]="{ th: tenderer.isHeader }"
    colspan="2"
    [innerHTML]="tenderer.amount"
  ></td>
  <td
    [ngClass]="{ th: tenderer.isHeader }"
    colspan="6"
    [innerHTML]="tenderer.remarks"
  ></td>
</ng-template>

<ng-template #tableTenderTendererBodyF>
  [#list tenderList as tenderer]
  <tr>
    <td colspan="4">{{ '${tenderer.nameSubcontractor!"&nbsp;"}' }}</td>
    <td colspan="2">
      {{
        '${companyCurrencyCode!""} ${((tenderer.budgetAmount!0) - (tenderer.amtBuyingGainLoss!0))?string["#,##0.00"]}'
      }}
    </td>
    <td colspan="6">{{ '${tenderer.remarks!"&nbsp;"}' }}</td>
  </tr>
  [/#list]
</ng-template>

<ng-template #tableTenderRcm>
  <table class="line2" id="tableTenderRcm">
    <tr>
      <td colspan="2">Recommendation</td>
    </tr>
    <tr>
      <td>
        <table>
          <tr>
            <td>Award to</td>
            <td class="border1b" [innerHTML]="get('rcmAward')">&nbsp;</td>
            <td>for</td>
          </tr>
        </table>
      </td>
      <td [innerHTML]="get('rcmAmount')"></td>
    </tr>
    <tr>
      <td>Tender & \ or Latest Forecast Budget *</td>
      <td [innerHTML]="get('rcmBudget')"></td>
    </tr>
    <tr>
      <td>Buying Gain \ (Loss)</td>
      <td [innerHTML]="get('rcmBuyLoss')"></td>
    </tr>
    <tr class="border1t">
      <td>Package Stretch Target ({{ get("rcmTargetPercent") }}% )</td>
      <td [innerHTML]="get('rcmTargetAmount')"></td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderRmk>
  <table class="line1-5" id="tableTenderRmk">
    <tr>
      <td colspan="2">Remarks</td>
    </tr>
    <tr>
      <td>Basis of Price</td>
      <td [innerHTML]="get('rmkPrice')"></td>
    </tr>
    <tr>
      <td>CPF</td>
      <td [innerHTML]="get('rmkCpf')"></td>
    </tr>
    <tr>
      <td>Payment Method</td>
      <td [innerHTML]="get('rmkPaymentMethod')"></td>
    </tr>
    <tr>
      <td>Period for Payment</td>
      <td [innerHTML]="get('rmkPeriod')"></td>
    </tr>
    <tr>
      <td>Limit of Retention</td>
      <td [innerHTML]="get('rmkTention')"></td>
    </tr>
    <tr>
      <td>Sub-Contract Duration</td>
      <td [innerHTML]="get('rmkDuration')"></td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderBy>
  <table class="footerComment" id="tableTenderBy">
    <tr>
      <td class="pr5">Tender Analysis Package prepared by</td>
      <td class="border1b" [innerHTML]="get('preparedUser')">&nbsp;</td>
      <td class="pl5 pr5">Date</td>
      <td class="border1b" [innerHTML]="get('preparedDate')">&nbsp;</td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderPds4_5_18 id="tableTenderPds4_5_18">
  <table class="footerComment">
    <tr>
      <td>
        Pre-Award Finalization Meeting held & minuted(<span class="pds"
          >PDS/07/4.5.18/Form 5</span
        >)
      </td>
      <td class="em2" [innerHTML]="get('preAward')"></td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderApprover let-approver="approver">
  <table class="approvedBy">
    <tr>
      <td colspan="2" [innerHTML]="approver.title">&nbsp;</td>
    </tr>
    <tr>
      <td class="border1b">&nbsp;</td>
      <td class="border1b">&nbsp;</td>
    </tr>
    <tr>
      <td [innerHTML]="approver.position"></td>
      <td>Date</td>
    </tr>
  </table>
</ng-template>

<ng-template #tableTenderApprovers let-approvers="approvers">
  <td colspan="6" *ngFor="let approver of approvers">
    <ng-container
      *ngTemplateOutlet="tableTenderApprover; context: { approver: approver }"
    ></ng-container>
  </td>
</ng-template>

<ng-template #table3Q>
  <table id="table3Q" class="border2">
    <tbody>
      <tr>
        <td>
          <table>
            <tr>
              <td colspan="2" class="headertitle">
                APPROVAL OF RELAXATION TO THREE MINIMUM QUOTATIONS
                REQUIREMENT(<span class="pds">PDS/07/4.5.10</span>)
              </td>
              <td rowspan="2">*</td>
              <td rowspan="2" class="yesno">
                <table class="border2">
                  <tbody>
                    <tr>
                      <td [innerHTML]="get('yesno3q')"></td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td>Reason:</td>
              <td class="border1b" [innerHTML]="get('threeQReason')">&nbsp;</td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="footerComment">
          **BU Commercial Lead & Director (All) \ Commercial Director (Package >
          $0.5M)
        </td>
      </tr>
    </tbody>
  </table>
</ng-template>

<ng-template #tableVariances>
  <table id="tableVariances" class="border2">
    <tbody>
      <tr>
        <td colspan="12">
          <table>
            <tr>
              <td colspan="2" class="headertitle">
                APPROVAL OF VARIANCES TO STANDARD FORMS(<span class="pds"
                  >PDS/07/4.5.17</span
                >)
              </td>
              <td rowspan="2">*</td>
              <td rowspan="2" class="yesno">
                <table class="border2">
                  <tbody>
                    <tr>
                      <td [innerHTML]="get('yesnoVariance')"></td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr *ngFor="let variance of get('varianceList')">
        <ng-container
          *ngTemplateOutlet="
            tableVariancesBody;
            context: { variance: variance }
          "
        ></ng-container>
      </tr>
      <ng-container *ngIf="mode == 'f'">
        <ng-container *ngTemplateOutlet="tableVariancesBodyF"></ng-container>
      </ng-container>
      <tr>
        <td colspan="12" class="footerComment">
          **BU Commercial Lead (All) \ Executive Commercial Director (Award >
          $10M)
        </td>
      </tr>
    </tbody>
  </table>
</ng-template>

<ng-template #tableVariancesBody let-variance="variance">
  <td
    [ngClass]="{ th: variance.isHeader }"
    colspan="2"
    [innerHTML]="variance.term"
  ></td>
  <td
    [ngClass]="{ th: variance.isHeader }"
    colspan="3"
    [innerHTML]="variance.condition"
  ></td>
  <td
    [ngClass]="{ th: variance.isHeader }"
    colspan="3"
    [innerHTML]="variance.proposed"
  ></td>
  <td
    [ngClass]="{ th: variance.isHeader }"
    colspan="4"
    [innerHTML]="variance.reason"
  ></td>
</ng-template>

<ng-template #tableVariancesBodyF>
  [#if tenderVarianceList??]
  [#list tenderVarianceList as variance]
  <tr>
    <td colspan="2">{{ '${variance.clause!"&nbsp;"}' }}</td>
    <td colspan="3">
      {{ '${variance.generalCondition!"&nbsp;"}' }}
    </td>
    <td colspan="3">
      {{ '${variance.proposedVariance!"&nbsp;"}' }}
    </td>
    <td colspan="4">
      {{ '${variance.reason!"&nbsp;"}' }}
    </td>
  </tr>
  [/#list]
  [/#if]
</ng-template>

<ng-template #tableChange>
  <table id="tableChange" class="border2">
    <tbody>
      <tr>
        <td>
          <table>
            <tr>
              <td colspan="3" class="headertitle">
                APPROVAL TO CHANGE MANNER OF EXECUTION FROM MAIN CONTRACT (<span
                  class="pds"
                  >PDS/07/4.5.23</span
                >)
              </td>
              <td rowspan="1">*</td>
              <td rowspan="1" class="yesno">
                <table class="border2">
                  <tbody>
                    <tr>
                      <td [innerHTML]="get('yesnoManner')"></td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td colspan="5">
                <table>
                  <tr>
                    <td rowspan="2" class="mainCertLeft">Reason:</td>
                    <td
                      rowspan="2"
                      class="border1b mainCertLeftInput"
                      [innerHTML]="get('changeMainCertReason')"
                    >
                      &nbsp;
                    </td>
                    <td class="mainCertRight pl5 pr5">
                      Method of Execution of Main Contract
                    </td>
                    <td
                      class="mainCertRightInput"
                      colspan="2"
                      class="border1b"
                      [innerHTML]="get('changeMainCertExecution')"
                    >
                      &nbsp;
                    </td>
                  </tr>
                  <tr>
                    <td class="pl5 pr5">Proposed Method of Execution</td>
                    <td
                      colspan="2"
                      class="border1b"
                      [innerHTML]="get('changeMainCertProposed')"
                    >
                      &nbsp;
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td>
          <table>
            <tr>
              <td colspan="3" class="headertitle">
                APPROVAL TO USE LETTER OF ACCEPTANCE(<span class="pds"
                  >PDS/07/4.5.25</span
                >)
              </td>
              <td rowspan="1">*</td>
              <td rowspan="1" class="yesno">
                <table class="border2">
                  <tbody>
                    <tr>
                      <td [innerHTML]="get('yesnoLoa')"></td>
                    </tr>
                  </tbody>
                </table>
              </td>
            </tr>
            <tr>
              <td colspan="5">
                <table>
                  <tr>
                    <td class="loaLeft pr5">Reason for use of LoA:</td>
                    <td
                      class="loaLeftInput border1b"
                      [innerHTML]="get('loaReason')"
                    >
                      &nbsp;
                    </td>
                    <td class="loaRight pl5 pr5">
                      Target Date for Sub-Contract Execution
                    </td>
                    <td
                      class="loaRightInput"
                      colspan="2"
                      class="border1b"
                      [innerHTML]="get('loaExecution')"
                    >
                      &nbsp;
                    </td>
                  </tr>
                </table>
              </td>
            </tr>
          </table>
        </td>
      </tr>
      <tr>
        <td class="footerComment">**BU Commercial Lead (All)</td>
      </tr>
    </tbody>
  </table>
</ng-template>

<ng-template #submit>
  [#-- PCMS start
  <br>
  <button
    class="btn btn-primary btn-block hidden-print"
    ng-click="submit()"
    ng-hide="disableButtons"
    ng-disabled="disableButtons"
  >
    <span class="fa fa-save"></span> <b>Submit</b>
  </button>
  PCMS end --#]
</ng-template>

<ng-template #dates>
  [#-- AP start --#]
  <div id="cdate">
    <table>
      <tr>
        <th colspan="2">Contractual Date</th>
      </tr>
      <tr *ngFor="let d of v.dateList">
        <td [innerHTML]="d.title"></td>
        <td [innerHTML]="d[mode]"></td>
      </tr>
    </table>
  </div>
  [#-- AP end --#]
</ng-template>

<ng-template #printBtn>
  [#-- PCMS start
  <br />
        <span class="pull-right hidden-print">
          <a
            href="javascript:;"
            onclick="window.print()"
            id="printBtn"
            class="btn btn-sm width-100 btn-rounded btn-danger hidden-print"
          >
            <i class="fa fa-print m-r-3"></i> Print
          </a>
        </span>
  PCMS end --#]
</ng-template>

<ng-template #logoBase64>
  <img class="GammonLogo" src='
  data:image/png;base64,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'/>
</ng-template>
